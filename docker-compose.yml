version: '2'
services:
    web-app:
        container_name: mecu_webservice
        build:
            context: .
            dockerfile: Dockerfile
        ports:
            - 80:3000
        depends_on:
            - database
        env_file:
            - app-variables.env

    database:
        container_name: mecu_postgresdb
        image: sacdallago/mecu-postgres
        ports:
            - 54322:5432

    nginx-proxy:
      image: jwilder/nginx-proxy
      container_name: nginx-proxy
      ports:
        - "80:80"
        - "443:443"
      volumes:
        - /var/run/docker.sock:/tmp/docker.sock:ro
        - /usr/share/nginx/html
        - /etc/nginx/vhost.d
        - certs-volume:/etc/nginx/certs:ro


volumes:
  certs-volume:
